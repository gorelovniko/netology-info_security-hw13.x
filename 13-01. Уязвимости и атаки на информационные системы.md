# Домашнее задание к занятию "`Уязвимости и атаки на информационные системы`" - `Горелов Николай`


### Задание 1

Скачайте и установите виртуальную машину Metasploitable: https://sourceforge.net/projects/metasploitable/.

Это типовая ОС для экспериментов в области информационной безопасности, с которой следует начать при анализе уязвимостей.

Просканируйте эту виртуальную машину, используя **nmap**.

Попробуйте найти уязвимости, которым подвержена эта виртуальная машина.

Сами уязвимости можно поискать на сайте https://www.exploit-db.com/.

Для этого нужно в поиске ввести название сетевой службы, обнаруженной на атакуемой машине, и выбрать подходящие по версии уязвимости.

Ответьте на следующие вопросы:

- Какие сетевые службы в ней разрешены?
- Какие уязвимости были вами обнаружены? (список со ссылками: достаточно трёх уязвимостей)
  
*Приведите ответ в свободной форме.*  

---

### Решение 1

#### **1. Обнаруженные сетевые службы**  
После сканирования **nmap** (`nmap -A 192.168.220.143`) были обнаружены следующие службы:  
- **21/tcp** – vsftpd 2.3.4  
- **22/tcp** – OpenSSH 4.7p1  
- **23/tcp** – telnetd  
- **25/tcp** – Postfix smtpd  
- **53/tcp** – ISC BIND 9.4.2  
- **80/tcp** – Apache httpd 2.2.8  
- **111/tcp** – rpcbind  
- **139/tcp, 445/tcp** – Samba smbd 3.X  
- **512/tcp, 513/tcp, 514/tcp** – rsh-like services  
- **1099/tcp** – Java RMI  
- **1524/tcp** – Metasploitable root shell  
- **2049/tcp** – NFS  
- **3306/tcp** – MySQL 5.0.51a  
- **5432/tcp** – PostgreSQL 8.3.0  
- **5900/tcp** – VNC  
- **6000/tcp** – X11  
- **6667/tcp** – UnrealIRCd  
- **8009/tcp** – Apache JServ Protocol  
- **8180/tcp** – Apache Tomcat  

#### **2. Найденные уязвимости**  
1. **vsftpd 2.3.4 – Backdoor Command Execution**  
   - **CVE:** CVE-2011-2523  
   - **Exploit-DB:** [https://www.exploit-db.com/exploits/17491](https://www.exploit-db.com/exploits/17491)  
   - **Описание:** Позволяет выполнить произвольные команды через backdoor в службе FTP.  

2. **UnrealIRCd 3.2.8.1 – Backdoor Command Execution**  
   - **CVE:** CVE-2010-2075  
   - **Exploit-DB:** [https://www.exploit-db.com/exploits/13853](https://www.exploit-db.com/exploits/13853)  
   - **Описание:** Содержит скрытый бэкдор, позволяющий выполнить команды от имени сервера.  

3. **Samba (usermap_script) – Remote Code Execution**  
   - **CVE:** CVE-2007-2447  
   - **Exploit-DB:** [https://www.exploit-db.com/exploits/16320](https://www.exploit-db.com/exploits/16320)  
   - **Описание:** Уязвимость в скрипте `username map`, позволяющая выполнить команды через некорректную обработку входных данных.  

---

### Задание 2

Проведите сканирование Metasploitable в режимах SYN, FIN, Xmas, UDP.

Запишите сеансы сканирования в Wireshark.

Ответьте на следующие вопросы:

- Чем отличаются эти режимы сканирования с точки зрения сетевого трафика?
- Как отвечает сервер?

*Приведите ответ в свободной форме.*

--

### Решение 2

#### **1. Различия в сетевом трафике**  
- **SYN-сканирование (`-sS`)**  
  - Отправляет **SYN-пакеты** на целевые порты.  
  - Если порт открыт, сервер отвечает **SYN-ACK**, после чего сканер отправляет **RST** (без завершения TCP-рукопожатия).  
  - **Трафик:** Быстрое, не создает полных соединений.  

- **FIN-сканирование (`-sF`)**  
  - Отправляет **FIN-пакеты** (без предварительного SYN).  
  - Если порт закрыт, сервер отвечает **RST**. Если открыт – игнорирует.  
  - **Трафик:** Менее заметное (не всегда регистрируется IDS).  

- **Xmas-сканирование (`-sX`)**  
  - Отправляет пакеты с флагами **FIN, PSH, URG** ("рождественская ёлка").  
  - Поведение аналогично FIN-сканированию: открытые порты игнорируют пакет, закрытые – отвечают RST.  
  - **Трафик:** Необычные флаги могут привлечь внимание систем защиты.  

- **UDP-сканирование (`-sU`)**  
  - Отправляет **UDP-пакеты** (без установки соединения).  
  - Если порт открыт, служба может ответить (но часто молчит). Если закрыт – может прийти **ICMP Port Unreachable**.  
  - **Трафик:** Медленное из-за таймаутов UDP.  

#### **2. Ответ сервера**  
- **SYN-сканирование:**  
  - Открытый порт → **SYN-ACK**  
  - Закрытый порт → **RST**  

- **FIN/Xmas-сканирование:**  
  - Открытый порт → **Нет ответа**  
  - Закрытый порт → **RST**  

- **UDP-сканирование:**  
  - Открытый порт → **Нет ответа или данные службы**  
  - Закрытый порт → **ICMP Port Unreachable**  

#### **Вывод**  
- **SYN** – самый быстрый и надежный для TCP.  
- **FIN/Xmas** – скрытые, но не всегда работают (зависит от ОС).  
- **UDP** – медленное, но необходимо для обнаружения UDP-сервисов (DNS, SNMP и т. д.).  

**Wireshark:** В режиме SYN видно классическое SYN→SYN-ACK→RST, в FIN/Xmas – только FIN-пакеты и RST в ответ, в UDP – пустые датаграммы и ICMP-ошибки.

---